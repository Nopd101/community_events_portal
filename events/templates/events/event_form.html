{% extends "events/dashboard_base.html" %} {% block sidebar %}
<h6 class="text-uppercase text-white-50 mb-3">Organizer</h6>
<ul class="nav flex-column gap-2">
  <li class="nav-item">
    <a
      class="nav-link text-white p-0"
      href="{% url 'events:organizer_dashboard' %}"
    >
      Dashboard
    </a>
  </li>
  <li class="nav-item">
    <a
      class="nav-link text-white p-0"
      href="{% url 'events:organizer_events' %}"
    >
      My events
    </a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-white p-0" href="{% url 'events:event_create' %}">
      Create event
    </a>
  </li>
  <li class="nav-item mt-3">
    <span class="text-white-50 small">Profile</span>
  </li>
  <li class="nav-item">
    <a
      class="nav-link text-white p-0"
      href="{% url 'events:organizer_profile' %}"
    >
      Edit profile
    </a>
  </li>
</ul>
{% endblock %} {% block main_content %}
<h5>{% if event %}Edit Event{% else %}Create Event{% endif %}</h5>

{% if form.non_field_errors %}
<div class="alert alert-danger">
  {% for err in form.non_field_errors %}{{ err }}<br />{% endfor %}
</div>
{% endif %}

<form method="post" enctype="multipart/form-data" novalidate>
  {% csrf_token %}
  {{ form.as_p }}

  <!-- Image preview -->
  <div class="mt-3">
    <img
      id="image-preview"
      {% if form.instance.image %}
        src="{{ form.instance.image.url }}"
        style="max-width: 250px; max-height: 250px;"
      {% else %}
        style="max-width: 250px; max-height: 250px; display: none;"
      {% endif %}
      alt="Event image preview"
    />
  </div>

  <div class="d-flex gap-2 mt-3">
    <button type="submit" class="btn btn-primary">
      {% if event %}Update{% else %}Save{% endif %}
    </button>
    <a
      href="{% url 'events:organizer_events' %}"
      class="btn btn-outline-secondary"
    >
      Cancel
    </a>
  </div>
</form>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const input = document.getElementById("id_image");   // Django's default id
    const preview = document.getElementById("image-preview");

    if (!input || !preview) return;

    input.addEventListener("change", function (event) {
      const file = event.target.files[0];

      if (!file) {
        preview.style.display = "none";
        preview.src = "";
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        preview.src = e.target.result;
        preview.style.display = "block";
      };
      reader.readAsDataURL(file);
    });
  });
</script>
{% endblock %}

{% extends "events/dashboard_base.html" %}

{% block sidebar %}
  <h6 class="text-uppercase mb-3 dashboard-sidebar-title text-dark">Admin</h6>
  <ul class="nav flex-column gap-2 dashboard-sidebar-nav">
    <li class="nav-item">
      <a class="nav-link sidebar-pill-link {% if request.resolver_match.url_name == 'admin_dashboard' %}active{% endif %}" href="{% url 'events:admin_dashboard' %}">
        <i class="bi bi-house-door"></i>
        Dashboard
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link sidebar-pill-link {% if request.resolver_match.url_name == 'admin_review' %}active{% endif %}" href="{% url 'events:admin_review' %}">
        <i class="bi bi-ui-checks-grid"></i>
        Review submissions
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link sidebar-pill-link {% if request.resolver_match.url_name == 'admin_feedback_overview' %}active{% endif %}" href="{% url 'events:admin_feedback_overview' %}">
        <i class="bi bi-calendar-event"></i>
        All events
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link sidebar-pill-link {% if request.resolver_match.url_name == 'admin_user_management' %}active{% endif %}" href="{% url 'events:admin_user_management' %}">
        <i class="bi bi-people"></i>
        User management
      </a>
    </li>
  </ul>
{% endblock %}

{% block main_content %}
  <div class="dashboard-banner mb-4">
      <h5 class="fw-bold fs-3 text-white">Admin Dashboard</h5>
  </div>

  <div class="row g-3 mb-3">
    <div class="col-md-3">
      <div class="card p-3 stat-card stat-card-green">
        <div class="stat-label">Upcoming events</div>
        <div class="stat-value value-green">{{ upcoming_events }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 stat-card stat-card-yellow">
        <div class="stat-label">Pending</div>
        <div class="stat-value value-yellow">{{ pending_events }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 stat-card stat-card-pink">
        <div class="stat-label">Declined</div>
        <div class="stat-value value-red">{{ declined_events }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 stat-card">
        <div class="stat-label">Total events</div>
        <div class="stat-value value-purple">{{ total_events }}</div>
      </div>
    </div>
  </div>

  <div class="row g-3 mb-3">
    <div class="col-md-3">
      <div class="card p-3 stat-card stat-card-purple">
        <div class="stat-label">Attendees</div>
        <div class="stat-value">{{ attendees }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 stat-card stat-card-blue">
        <div class="stat-label">Organizers</div>
        <div class="stat-value">{{ organizers }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 stat-card stat-card-orange">
        <div class="stat-label">Admins</div>
        <div class="stat-value">{{ admins }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 stat-card">
        <div class="stat-label">Total users</div>
        <div class="stat-value value-purple">{{ total_users }}</div>
      </div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <div class="card p-3 h-100 panel-card">
        <h6 class="panel-title">Events in the next 7 days</h6>
        {% if events_next_week %}
          <ul class="list-group list-group-flush mt-2 panel-list">
            {% for e in events_next_week %}
              <li class="list-group-item px-0 panel-list-item">
                <strong>{{ e.title }}</strong>
                <span class="text-muted small">– {{ e.date|date:"M d, Y" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted mt-2">No upcoming events this week.</p>
        {% endif %}
      </div>
    </div>

    <div class="col-md-6">
      <div class="card p-3 h-100 panel-card">
        <h6 class="panel-title">Top rated events</h6>
        {% if top_events %}
          <ul class="list-group list-group-flush mt-2 panel-list">
            {% for avg, count, e in top_events %}
              <li class="list-group-item px-0">
                <strong>{{ e.title }}</strong>
                <span class="text-muted small">
                  – ⭐ {{ avg }}/5 ({{ count }} reviews)
                </span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted mt-2">No feedback yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}